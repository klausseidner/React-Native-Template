////////////////////////////////////////////////////////////////////////////////////////////////////
// Utilitario para generar tokens JWT
////////////////////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////////////////////////
// Importações
////////////////////////////////////////////////////////////////////////////////////////////////////
const jwt = require('jsonwebtoken'); // Importa o módulo jsonwebtoken

////////////////////////////////////////////////////////////////////////////////////////////////////
// Função para gerar um token JWT
////////////////////////////////////////////////////////////////////////////////////////////////////
function generateToken(user) {
  return jwt.sign({ id: user.id, role: user.role }, process.env.JWT_SECRET, { // Gera um token com o ID e o papel do usuário
    expiresIn: process.env.JWT_EXPIRATION || '1h', // Define o tempo de expiração do token
  });
}

module.exports = { generateToken }; // Exporta a função de geração de token

////////////////////////////////////////////////////////////////////////////////////////////////////